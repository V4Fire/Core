<!doctype html>
<html class="default no-js">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>src/core/cache/decorators/persistent | V4Fire</title>
	<meta name="description" content="Documentation for V4Fire">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="../assets/css/main.css">
	<script async src="../assets/js/search.js" id="search-script"></script>
<style>/*!
 * V4Fire Core
 * https://github.com/V4Fire/Core
 *
 * Released under the MIT license
 * https://github.com/V4Fire/Core/blob/master/LICENSE
 */

body {
	font-family: -apple-system, BlinkMacSystemFont, Segoe UI, Helvetica, Arial, sans-serif, Apple Color Emoji, Segoe UI Emoji;
}

code, pre, tt {
	font-family: SFMono-Regular, Consolas, Liberation Mono, Menlo, monospace;
}

.tsd-typography h1,
.tsd-typography h2,
.tsd-typography h3,
.tsd-typography h4,
.tsd-typography h5,
.tsd-typography h6 {
	margin: 1em 0;
	font-family: -apple-system, BlinkMacSystemFont, UI, Helvetica, Arial, sans-serif, Apple Color Emoji, Segoe UI Emoji;
}

.tsd-panel {
	padding: 20px 40px;
	border: 1px solid #DDD;
	border-radius: 10px;
	box-shadow: none;
}

.tsd-page-title {
	color: #EEE;

	background: #232526; /* fallback for old browsers */
	background: -webkit-linear-gradient(to right, #414345, #232526); /* Chrome 10-25, Safari 5.1-6 */
	background: linear-gradient(to right, #414345, #232526); /* W3C, IE 10+/ Edge, Firefox 16+, Chrome 26+, Opera 12+, Safari 7+ */
}

.tsd-page-toolbar {
	height: 43px;
}

.title {
	display: inline-flex;
	align-items: center;
}

.title::before {
	content: "";

	display: inline-block;
	width: 20px;
	height: 20px;
	margin-right: 10px;

	border-radius: 5px;
	background-image: url("https://avatars0.githubusercontent.com/u/29952525?s=200&v=4");
	background-size: contain;
}

#tsd-search .tsd-widget.search.no-caption {
	bottom: 0;
}

#tsd-search .field {
	height: 100%;
}

pre {
	background-color: rgba(7, 7, 7, 0.01);
}

/**
 * GitHub Gist Theme
 * Author : Anthony Attard - https://github.com/AnthonyAttard
 * Author : Louis Barranqueiro - https://github.com/LouisBarranqueiro
 */

.hljs {
	display: block;
	background: white;
	padding: 0.5em;
	color: #333333;
	overflow-x: auto;
}

.hljs-comment,
.hljs-meta {
	color: #969896;
}

.hljs-variable,
.hljs-template-variable,
.hljs-strong,
.hljs-emphasis,
.hljs-quote {
	color: #df5000;
}

.hljs-keyword,
.hljs-selector-tag,
.hljs-type {
	color: #d73a49;
}

.hljs-literal,
.hljs-symbol,
.hljs-bullet,
.hljs-attribute {
	color: #0086b3;
}

.hljs-section,
.hljs-name {
	color: #63a35c;
}

.hljs-tag {
	color: #333333;
}

.hljs-title,
.hljs-attr,
.hljs-selector-id,
.hljs-selector-class,
.hljs-selector-attr,
.hljs-selector-pseudo {
	color: #6f42c1;
}

.hljs-addition {
	color: #55a532;
	background-color: #eaffea;
}

.hljs-deletion {
	color: #bd2c00;
	background-color: #ffecec;
}

.hljs-link {
	text-decoration: underline;
}

.hljs-number {
	color: #005cc5;
}

.hljs-string {
	color: #032f62;
}
</style>
</head>
<body>
<script>'use strict';

/*!
 * V4Fire Core
 * https://github.com/V4Fire/Core
 *
 * Released under the MIT license
 * https://github.com/V4Fire/Core/blob/master/LICENSE
 */

(function () {
	if (localStorage.getItem('visibility') == null) {
		localStorage.setItem('visibility', 'public');
	}

	document.title = document.title.replace(/['"]+|src\//g, '');
	document.body.style.display = 'none';
})();
</script>
<header>
	<div class="tsd-page-toolbar">
		<div class="container">
			<div class="table-wrap">
				<div class="table-cell" id="tsd-search" data-index="../assets/js/search.json" data-base="..">
					<div class="field">
						<label for="tsd-search-field" class="tsd-widget search no-caption">Search</label>
						<input id="tsd-search-field" type="text" />
					</div>
					<ul class="results">
						<li class="state loading">Preparing search index...</li>
						<li class="state failure">The search index is not available</li>
					</ul>
					<a href="../index.html" class="title">V4Fire</a>
				</div>
				<div class="table-cell" id="tsd-widgets">
					<div id="tsd-filter">
						<a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a>
						<div class="tsd-filter-group">
							<div class="tsd-select" id="tsd-filter-visibility">
								<span class="tsd-select-label">All</span>
								<ul class="tsd-select-list">
									<li data-value="public">Public</li>
									<li data-value="protected">Public/Protected</li>
									<li data-value="private" class="selected">All</li>
								</ul>
							</div>
							<input type="checkbox" id="tsd-filter-inherited" checked />
							<label class="tsd-widget" for="tsd-filter-inherited">Inherited</label>
						</div>
					</div>
					<a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a>
				</div>
			</div>
		</div>
	</div>
	<div class="tsd-page-title">
		<div class="container">
			<ul class="tsd-breadcrumb">
				<li>
					<a href="../modules.html">V4Fire</a>
				</li>
				<li>
					<a href="src_core_cache_decorators_persistent.html">src/core/cache/decorators/persistent</a>
				</li>
			</ul>
			<h1>Module src/core/cache/decorators/persistent</h1>
		</div>
	</div>
</header>
<div class="container container-main">
	<div class="row">
		<div class="col-8 col-content">
			<section class="tsd-panel tsd-comment">
				<div class="tsd-comment tsd-typography">
					<div class="lead">
						<a href="#corecachedecoratorspersistent" id="corecachedecoratorspersistent" style="color: inherit; text-decoration: none;">
							<h1>core/cache/decorators/persistent</h1>
						</a>
						<p>This module provides a wrapper for <a href="src_core_cache.html#cache">Cache</a> data structures to add a feature of persistent data storing.
							To describe how long should keep an item in the persistent cache, use the <code>persistentTTL</code> parameter.
						The value for <code>persistentTTL</code> should be provided in milliseconds.</p>
						<a href="#example" id="example" style="color: inherit; text-decoration: none;">
							<h2>Example</h2>
						</a>
						<pre><code class="language-js"><span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">asyncLocal</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;core/kv-storage&#039;</span><span style="color: #000000">;</span>

<span style="color: #AF00DB">import</span><span style="color: #000000"> </span><span style="color: #001080">addPersistent</span><span style="color: #000000"> </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;core/cache/decorators/persistent&#039;</span><span style="color: #000000">;</span>
<span style="color: #AF00DB">import</span><span style="color: #000000"> </span><span style="color: #001080">SimpleCache</span><span style="color: #000000"> </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;core/cache/simple&#039;</span><span style="color: #000000">;</span>

<span style="color: #0000FF">const</span>
<span style="color: #000000">  </span><span style="color: #0070C1">opts</span><span style="color: #000000"> = {</span><span style="color: #001080">loadFromStorage:</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;onInit&#039;</span><span style="color: #000000">},</span>
<span style="color: #000000">  </span><span style="color: #0070C1">persistentCache</span><span style="color: #000000"> = </span><span style="color: #AF00DB">await</span><span style="color: #000000"> </span><span style="color: #795E26">addPersistent</span><span style="color: #000000">(</span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">SimpleCache</span><span style="color: #000000">(), </span><span style="color: #001080">asyncLocal</span><span style="color: #000000">, </span><span style="color: #001080">opts</span><span style="color: #000000">);</span>

<span style="color: #AF00DB">await</span><span style="color: #000000"> </span><span style="color: #001080">persistentCache</span><span style="color: #000000">.</span><span style="color: #795E26">set</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;foo&#039;</span><span style="color: #000000">, </span><span style="color: #A31515">&#039;bar&#039;</span><span style="color: #000000">, {</span><span style="color: #001080">persistentTTL:</span><span style="color: #000000"> (</span><span style="color: #098658">2</span><span style="color: #000000">).</span><span style="color: #795E26">seconds</span><span style="color: #000000">()});</span>
<span style="color: #AF00DB">await</span><span style="color: #000000"> </span><span style="color: #001080">persistentCache</span><span style="color: #000000">.</span><span style="color: #795E26">set</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;foo2&#039;</span><span style="color: #000000">, </span><span style="color: #A31515">&#039;bar2&#039;</span><span style="color: #000000">);</span>

<span style="color: #008000">// Cause we use the same instance for the local data storing,</span>
<span style="color: #008000">// this cache will have all values from the previous (it will be loaded from the storage during initialization)</span>

<span style="color: #0000FF">const</span>
<span style="color: #000000">  </span><span style="color: #0070C1">copyOfCache</span><span style="color: #000000"> = </span><span style="color: #AF00DB">await</span><span style="color: #000000"> </span><span style="color: #795E26">addPersistent</span><span style="color: #000000">(</span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">SimpleCache</span><span style="color: #000000">(), </span><span style="color: #001080">asyncLocal</span><span style="color: #000000">, </span><span style="color: #001080">opts</span><span style="color: #000000">);</span>
</code></pre>
						<a href="#options" id="options" style="color: inherit; text-decoration: none;">
							<h2>Options</h2>
						</a>
						<a href="#persistentttl" id="persistentttl" style="color: inherit; text-decoration: none;">
							<h3>persistentTTL</h3>
						</a>
						<p>The option specifies the default TTL to keep items within the persistent storage in milliseconds.
						This value is used when you don&#39;t provide the <code>persistentTTL</code> parameter when saving an item.</p>
						<pre><code class="language-js"><span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">asyncLocal</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;core/kv-storage&#039;</span><span style="color: #000000">;</span>

<span style="color: #AF00DB">import</span><span style="color: #000000"> </span><span style="color: #001080">addPersistent</span><span style="color: #000000"> </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;core/cache/decorators/persistent&#039;</span><span style="color: #000000">;</span>
<span style="color: #AF00DB">import</span><span style="color: #000000"> </span><span style="color: #001080">SimpleCache</span><span style="color: #000000"> </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;core/cache/simple&#039;</span><span style="color: #000000">;</span>

<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">persistentCache</span><span style="color: #000000"> = </span><span style="color: #AF00DB">await</span><span style="color: #000000"> </span><span style="color: #795E26">addPersistent</span><span style="color: #000000">(</span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">SimpleCache</span><span style="color: #000000">(), </span><span style="color: #001080">asyncLocal</span><span style="color: #000000">, {</span>
<span style="color: #000000">  </span><span style="color: #001080">persistentTTL:</span><span style="color: #000000"> (</span><span style="color: #098658">60</span><span style="color: #000000">).</span><span style="color: #795E26">seconds</span><span style="color: #000000">()</span>
<span style="color: #000000">});</span>

<span style="color: #008000">// If we &quot;reload&quot; the cache from the storage by using the browser reloading or another way,</span>
<span style="color: #008000">// these saved values can be &quot;restored&quot; from the storage only for the next 60 seconds</span>
<span style="color: #AF00DB">await</span><span style="color: #000000"> </span><span style="color: #001080">persistentCache</span><span style="color: #000000">.</span><span style="color: #795E26">set</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;foo&#039;</span><span style="color: #000000">, </span><span style="color: #A31515">&#039;bar&#039;</span><span style="color: #000000">);</span>
<span style="color: #AF00DB">await</span><span style="color: #000000"> </span><span style="color: #001080">persistentCache</span><span style="color: #000000">.</span><span style="color: #795E26">set</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;foo2&#039;</span><span style="color: #000000">, </span><span style="color: #A31515">&#039;bar2&#039;</span><span style="color: #000000">);</span>
</code></pre>
						<a href="#loadfromstorage" id="loadfromstorage" style="color: inherit; text-decoration: none;">
							<h3>loadFromStorage</h3>
						</a>
						<p>There is more than one way to initialize a cache from persistent storage.
							The most obvious way to do it is to load all data from the storage to RAM during the cache&#39;s initialization.
							This strategy is simple but not effective cause if we can have a huge amount of data in the storage,
							so we have to load it all at the same time. This can be very expensive. We need another way.
							But what if we load an item from the cache only when it is requested the first time.
							In that case, we haven&#39;t to load the whole stored data on cache initialization,
							but all cache methods will change API - they will become return promises instead of the raw results.
						Some consumers cannot be ready for changing API, so there is no silver bullet. We have to keep both strategies.</p>
						<a href="#oninit" id="oninit" style="color: inherit; text-decoration: none;">
							<h4>onInit</h4>
						</a>
						<p>The whole stored data will be loaded during the cache initialization
							Notice, cause the loading from the storage is an asynchronous operation, <code>addPersistent</code> will return a promise
						if used the <code>onInit</code> strategy.</p>
						<pre><code class="language-js"><span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">asyncLocal</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;core/kv-storage&#039;</span><span style="color: #000000">;</span>

<span style="color: #AF00DB">import</span><span style="color: #000000"> </span><span style="color: #001080">addPersistent</span><span style="color: #000000"> </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;core/cache/decorators/persistent&#039;</span><span style="color: #000000">;</span>
<span style="color: #AF00DB">import</span><span style="color: #000000"> </span><span style="color: #001080">SimpleCache</span><span style="color: #000000"> </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;core/cache/simple&#039;</span><span style="color: #000000">;</span>

<span style="color: #0000FF">const</span>
<span style="color: #000000">  </span><span style="color: #0070C1">opts</span><span style="color: #000000"> = {</span><span style="color: #001080">loadFromStorage:</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;onInit&#039;</span><span style="color: #000000">};</span>
<span style="color: #000000">  </span><span style="color: #001080">persistentCache</span><span style="color: #000000"> = </span><span style="color: #AF00DB">await</span><span style="color: #000000"> </span><span style="color: #795E26">addPersistent</span><span style="color: #000000">(</span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">SimpleCache</span><span style="color: #000000">(), </span><span style="color: #001080">asyncLocal</span><span style="color: #000000">, </span><span style="color: #001080">opts</span><span style="color: #000000">);</span>

<span style="color: #AF00DB">await</span><span style="color: #000000"> </span><span style="color: #001080">persistentCache</span><span style="color: #000000">.</span><span style="color: #795E26">set</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;foo&#039;</span><span style="color: #000000">, </span><span style="color: #A31515">&#039;bar&#039;</span><span style="color: #000000">);</span>
<span style="color: #AF00DB">await</span><span style="color: #000000"> </span><span style="color: #001080">persistentCache</span><span style="color: #000000">.</span><span style="color: #795E26">set</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;foo2&#039;</span><span style="color: #000000">, </span><span style="color: #A31515">&#039;bar2&#039;</span><span style="color: #000000">);</span>

<span style="color: #008000">// All properties already in our `Simple` cache</span>
<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">copyOfCache</span><span style="color: #000000"> = </span><span style="color: #AF00DB">await</span><span style="color: #000000"> </span><span style="color: #795E26">addPersistent</span><span style="color: #000000">(</span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">SimpleCache</span><span style="color: #000000">(), </span><span style="color: #001080">asyncLocal</span><span style="color: #000000">, </span><span style="color: #001080">opts</span><span style="color: #000000">);</span>

<span style="color: #001080">console</span><span style="color: #000000">.</span><span style="color: #795E26">log</span><span style="color: #000000">(</span><span style="color: #001080">copyOfCache</span><span style="color: #000000">.</span><span style="color: #795E26">get</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;foo&#039;</span><span style="color: #000000">) === </span><span style="color: #A31515">&#039;bar&#039;</span><span style="color: #000000">);</span>
</code></pre>
						<a href="#ondemand" id="ondemand" style="color: inherit; text-decoration: none;">
							<h4>onDemand</h4>
						</a>
						<p>Each stored item will be loaded from the cache only on the first touch, i.e. on-demand or lazily.
						This is the default strategy.</p>
						<pre><code class="language-js"><span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">asyncLocal</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;core/kv-storage&#039;</span><span style="color: #000000">;</span>

<span style="color: #AF00DB">import</span><span style="color: #000000"> </span><span style="color: #001080">addPersistent</span><span style="color: #000000"> </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;core/cache/decorators/persistent&#039;</span><span style="color: #000000">;</span>
<span style="color: #AF00DB">import</span><span style="color: #000000"> </span><span style="color: #001080">SimpleCache</span><span style="color: #000000"> </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;core/cache/simple&#039;</span><span style="color: #000000">;</span>

<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">persistentCache</span><span style="color: #000000"> = </span><span style="color: #AF00DB">await</span><span style="color: #000000"> </span><span style="color: #795E26">addPersistent</span><span style="color: #000000">(</span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">SimpleCache</span><span style="color: #000000">(), </span><span style="color: #001080">asyncLocal</span><span style="color: #000000">);</span>

<span style="color: #AF00DB">await</span><span style="color: #000000"> </span><span style="color: #001080">persistentCache</span><span style="color: #000000">.</span><span style="color: #795E26">set</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;foo&#039;</span><span style="color: #000000">, </span><span style="color: #A31515">&#039;bar&#039;</span><span style="color: #000000">);</span>
<span style="color: #AF00DB">await</span><span style="color: #000000"> </span><span style="color: #001080">persistentCache</span><span style="color: #000000">.</span><span style="color: #795E26">set</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;foo2&#039;</span><span style="color: #000000">, </span><span style="color: #A31515">&#039;bar2&#039;</span><span style="color: #000000">);</span>

<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">copyOfCache</span><span style="color: #000000"> = </span><span style="color: #AF00DB">await</span><span style="color: #000000"> </span><span style="color: #795E26">addPersistent</span><span style="color: #000000">(</span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">SimpleCache</span><span style="color: #000000">(), </span><span style="color: #001080">asyncLocal</span><span style="color: #000000">);</span>

<span style="color: #001080">console</span><span style="color: #000000">.</span><span style="color: #795E26">log</span><span style="color: #000000">(</span><span style="color: #AF00DB">await</span><span style="color: #000000"> </span><span style="color: #001080">copyOfCache</span><span style="color: #000000">.</span><span style="color: #795E26">get</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;foo&#039;</span><span style="color: #000000">) === </span><span style="color: #A31515">&#039;bar&#039;</span><span style="color: #000000">);</span>
</code></pre>
						<a href="#onofflinedemand" id="onofflinedemand" style="color: inherit; text-decoration: none;">
							<h4>onOfflineDemand</h4>
						</a>
						<p>Each stored item will be loaded from the cache only on the first touch and only if there is no internet connection.
						The strategy is useful to create net-first offline storages.</p>
						<pre><code class="language-js"><span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">isOnline</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;core/net&#039;</span><span style="color: #000000">;</span>
<span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">asyncLocal</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;core/kv-storage&#039;</span><span style="color: #000000">;</span>

<span style="color: #AF00DB">import</span><span style="color: #000000"> </span><span style="color: #001080">addPersistent</span><span style="color: #000000"> </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;core/cache/decorators/persistent&#039;</span><span style="color: #000000">;</span>
<span style="color: #AF00DB">import</span><span style="color: #000000"> </span><span style="color: #001080">SimpleCache</span><span style="color: #000000"> </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;core/cache/simple&#039;</span><span style="color: #000000">;</span>

<span style="color: #0000FF">const</span>
<span style="color: #000000">  </span><span style="color: #0070C1">opts</span><span style="color: #000000"> = {</span><span style="color: #001080">loadFromStorage:</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;onOfflineDemand&#039;</span><span style="color: #000000">},</span>
<span style="color: #000000">  </span><span style="color: #0070C1">persistentCache</span><span style="color: #000000"> = </span><span style="color: #AF00DB">await</span><span style="color: #000000"> </span><span style="color: #795E26">addPersistent</span><span style="color: #000000">(</span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">SimpleCache</span><span style="color: #000000">(), </span><span style="color: #001080">asyncLocal</span><span style="color: #000000">, </span><span style="color: #001080">opts</span><span style="color: #000000">);</span>

<span style="color: #AF00DB">await</span><span style="color: #000000"> </span><span style="color: #001080">persistentCache</span><span style="color: #000000">.</span><span style="color: #795E26">set</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;foo&#039;</span><span style="color: #000000">, </span><span style="color: #A31515">&#039;bar&#039;</span><span style="color: #000000">);</span>
<span style="color: #AF00DB">await</span><span style="color: #000000"> </span><span style="color: #001080">persistentCache</span><span style="color: #000000">.</span><span style="color: #795E26">set</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;foo2&#039;</span><span style="color: #000000">, </span><span style="color: #A31515">&#039;bar2&#039;</span><span style="color: #000000">);</span>

<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">copyOfCache</span><span style="color: #000000"> = </span><span style="color: #AF00DB">await</span><span style="color: #000000"> </span><span style="color: #795E26">addPersistent</span><span style="color: #000000">(</span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">SimpleCache</span><span style="color: #000000">(), </span><span style="color: #001080">asyncLocal</span><span style="color: #000000">, </span><span style="color: #001080">opts</span><span style="color: #000000">);</span>

<span style="color: #AF00DB">if</span><span style="color: #000000"> ((</span><span style="color: #AF00DB">await</span><span style="color: #000000"> </span><span style="color: #795E26">isOnline</span><span style="color: #000000">()).</span><span style="color: #001080">status</span><span style="color: #000000">) {</span>
<span style="color: #000000">  </span><span style="color: #001080">console</span><span style="color: #000000">.</span><span style="color: #795E26">log</span><span style="color: #000000">(</span><span style="color: #AF00DB">await</span><span style="color: #000000"> </span><span style="color: #001080">copyOfCache</span><span style="color: #000000">.</span><span style="color: #795E26">get</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;foo&#039;</span><span style="color: #000000">) !== </span><span style="color: #A31515">&#039;bar&#039;</span><span style="color: #000000">);</span>

<span style="color: #000000">} </span><span style="color: #AF00DB">else</span><span style="color: #000000"> {</span>
<span style="color: #000000">  </span><span style="color: #001080">console</span><span style="color: #000000">.</span><span style="color: #795E26">log</span><span style="color: #000000">(</span><span style="color: #AF00DB">await</span><span style="color: #000000"> </span><span style="color: #001080">copyOfCache</span><span style="color: #000000">.</span><span style="color: #795E26">get</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;foo&#039;</span><span style="color: #000000">) === </span><span style="color: #A31515">&#039;bar&#039;</span><span style="color: #000000">);</span>
<span style="color: #000000">}</span>
</code></pre>
					</div>
				</div>
			</section>
			<section class="tsd-panel-group tsd-index-group">
				<h2>Index</h2>
				<section class="tsd-panel tsd-index-panel">
					<div class="tsd-index-content">
						<section class="tsd-index-section ">
							<h3>References</h3>
							<ul class="tsd-index-list">
								<li class="tsd-kind-reference tsd-parent-kind-module"><a href="src_core_cache_decorators_persistent.html#persistentcache" class="tsd-kind-icon">Persistent<wbr>Cache</a></li>
								<li class="tsd-kind-reference tsd-parent-kind-module"><a href="src_core_cache_decorators_persistent.html#persistentoptions" class="tsd-kind-icon">Persistent<wbr>Options</a></li>
								<li class="tsd-kind-reference tsd-parent-kind-module"><a href="src_core_cache_decorators_persistent.html#persistentttldecoratoroptions" class="tsd-kind-icon">PersistentTTLDecorator<wbr>Options</a></li>
							</ul>
						</section>
						<section class="tsd-index-section ">
							<h3>Functions</h3>
							<ul class="tsd-index-list">
								<li class="tsd-kind-function tsd-parent-kind-module tsd-has-type-parameter"><a href="src_core_cache_decorators_persistent.html#default" class="tsd-kind-icon">default</a></li>
							</ul>
						</section>
					</div>
				</section>
			</section>
			<section class="tsd-panel-group tsd-member-group ">
				<h2>References</h2>
				<section class="tsd-panel tsd-member tsd-kind-reference tsd-parent-kind-module">
					<a name="persistentcache" class="tsd-anchor"></a>
					<h3>Persistent<wbr>Cache</h3>
					Re-exports <a href="src_core_cache_decorators_persistent_interface.html#persistentcache">PersistentCache</a>
				</section>
				<section class="tsd-panel tsd-member tsd-kind-reference tsd-parent-kind-module">
					<a name="persistentoptions" class="tsd-anchor"></a>
					<h3>Persistent<wbr>Options</h3>
					Re-exports <a href="../interfaces/src_core_cache_decorators_persistent_interface.persistentoptions.html">PersistentOptions</a>
				</section>
				<section class="tsd-panel tsd-member tsd-kind-reference tsd-parent-kind-module">
					<a name="persistentttldecoratoroptions" class="tsd-anchor"></a>
					<h3>PersistentTTLDecorator<wbr>Options</h3>
					Re-exports <a href="../interfaces/src_core_cache_decorators_persistent_interface.persistentttldecoratoroptions.html">PersistentTTLDecoratorOptions</a>
				</section>
			</section>
			<section class="tsd-panel-group tsd-member-group ">
				<h2>Functions</h2>
				<section class="tsd-panel tsd-member tsd-kind-function tsd-parent-kind-module tsd-has-type-parameter">
					<a name="default" class="tsd-anchor"></a>
					<h3><span class="tsd-flag ts-flagConst">Const</span> default</h3>
					<ul class="tsd-signatures tsd-kind-function tsd-parent-kind-module tsd-has-type-parameter">
						<li class="tsd-signature tsd-kind-icon">default&lt;V&gt;<span class="tsd-signature-symbol">(</span>cache<span class="tsd-signature-symbol">: </span><a href="../interfaces/src_core_cache_interface.default.html" class="tsd-signature-type" data-tsd-kind="Interface">default</a><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">V</span><span class="tsd-signature-symbol">, </span><span class="tsd-signature-type">string</span><span class="tsd-signature-symbol">&gt;</span>, storage<span class="tsd-signature-symbol">: </span><a href="../interfaces/src_core_kv_storage_interface.syncstoragenamespace.html" class="tsd-signature-type" data-tsd-kind="Interface">SyncStorageNamespace</a><span class="tsd-signature-symbol"> | </span><a href="src_core_kv_storage_interface.html#asyncstoragenamespace" class="tsd-signature-type" data-tsd-kind="Type alias">AsyncStorageNamespace</a>, opts<span class="tsd-signature-symbol">?: </span><a href="../interfaces/src_core_cache_decorators_persistent_interface.persistentoptions.html" class="tsd-signature-type" data-tsd-kind="Interface">PersistentOptions</a><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><a href="src_core_cache_decorators_persistent_interface.html#persistentcache" class="tsd-signature-type" data-tsd-kind="Type alias">PersistentCache</a><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">V</span><span class="tsd-signature-symbol">, </span><span class="tsd-signature-type">string</span><span class="tsd-signature-symbol">, </span><a href="../interfaces/src_core_cache_decorators_helpers_add_emitter_interface.cachewithemitter.html" class="tsd-signature-type" data-tsd-kind="Interface">CacheWithEmitter</a><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">V</span><span class="tsd-signature-symbol">, </span><span class="tsd-signature-type">string</span><span class="tsd-signature-symbol">, </span><a href="../interfaces/src_core_cache_interface.default.html" class="tsd-signature-type" data-tsd-kind="Interface">default</a><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">V</span><span class="tsd-signature-symbol">, </span><span class="tsd-signature-type">string</span><span class="tsd-signature-symbol">&gt;</span><span class="tsd-signature-symbol">&gt;</span><span class="tsd-signature-symbol">&gt;</span><span class="tsd-signature-symbol">&gt;</span></li>
					</ul>
					<ul class="tsd-descriptions">
						<li class="tsd-description">
							<aside class="tsd-sources">
								<ul>
									<li>Defined in <a href="https://github.com/V4Fire/Core/blob/master/src/core/cache/decorators/persistent/index.ts#L52">src/core/cache/decorators/persistent/index.ts:52</a></li>
								</ul>
							</aside>
							<div class="tsd-comment tsd-typography">
								<div class="lead">
									<p>Wraps the specified cache object to add a feature of persistent data storing</p>
								</div>
								<dl class="tsd-comment-tags">
									<dt>example</dt>
									<dd><pre><code class="language-typescript"><span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">asyncLocal</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;core/kv-storage&#039;</span><span style="color: #000000">;</span>

<span style="color: #AF00DB">import</span><span style="color: #000000"> </span><span style="color: #001080">addPersistent</span><span style="color: #000000"> </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;core/cache/decorators/persistent&#039;</span><span style="color: #000000">;</span>
<span style="color: #AF00DB">import</span><span style="color: #000000"> </span><span style="color: #001080">SimpleCache</span><span style="color: #000000"> </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;core/cache/simple&#039;</span><span style="color: #000000">;</span>

<span style="color: #0000FF">const</span>
<span style="color: #000000">  </span><span style="color: #0070C1">opts</span><span style="color: #000000"> = {</span><span style="color: #001080">loadFromStorage:</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;onInit&#039;</span><span style="color: #000000">},</span>
<span style="color: #000000">  </span><span style="color: #0070C1">persistentCache</span><span style="color: #000000"> = </span><span style="color: #AF00DB">await</span><span style="color: #000000"> </span><span style="color: #795E26">addPersistent</span><span style="color: #000000">(</span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">SimpleCache</span><span style="color: #000000">(), </span><span style="color: #001080">asyncLocal</span><span style="color: #000000">, </span><span style="color: #001080">opts</span><span style="color: #000000">);</span>

<span style="color: #AF00DB">await</span><span style="color: #000000"> </span><span style="color: #001080">persistentCache</span><span style="color: #000000">.</span><span style="color: #795E26">set</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;foo&#039;</span><span style="color: #000000">, </span><span style="color: #A31515">&#039;bar&#039;</span><span style="color: #000000">, {</span><span style="color: #001080">persistentTTL:</span><span style="color: #000000"> (</span><span style="color: #098658">2</span><span style="color: #000000">).</span><span style="color: #795E26">seconds</span><span style="color: #000000">()});</span>
<span style="color: #AF00DB">await</span><span style="color: #000000"> </span><span style="color: #001080">persistentCache</span><span style="color: #000000">.</span><span style="color: #795E26">set</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;foo2&#039;</span><span style="color: #000000">, </span><span style="color: #A31515">&#039;bar2&#039;</span><span style="color: #000000">);</span>

<span style="color: #008000">// Cause we use the same instance for the local data storing,</span>
<span style="color: #008000">// this cache will have all values from the previous (it will be loaded from the storage during initialization)</span>

<span style="color: #0000FF">const</span>
<span style="color: #000000">  </span><span style="color: #0070C1">copyOfCache</span><span style="color: #000000"> = </span><span style="color: #AF00DB">await</span><span style="color: #000000"> </span><span style="color: #795E26">addPersistent</span><span style="color: #000000">(</span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">SimpleCache</span><span style="color: #000000">(), </span><span style="color: #001080">asyncLocal</span><span style="color: #000000">, </span><span style="color: #001080">opts</span><span style="color: #000000">);</span>
</code></pre>
									</dd>
								</dl>
							</div>
							<h4 class="tsd-type-parameters-title">Type parameters</h4>
							<ul class="tsd-type-parameters">
								<li>
									<h4>V</h4>
									<div class="tsd-comment tsd-typography">
										<p>value type of the cache object</p>
									</div>
								</li>
							</ul>
							<h4 class="tsd-parameters-title">Parameters</h4>
							<ul class="tsd-parameters">
								<li>
									<h5>cache: <a href="../interfaces/src_core_cache_interface.default.html" class="tsd-signature-type" data-tsd-kind="Interface">default</a><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">V</span><span class="tsd-signature-symbol">, </span><span class="tsd-signature-type">string</span><span class="tsd-signature-symbol">&gt;</span></h5>
									<div class="tsd-comment tsd-typography">
										<p>cache object to wrap</p>
									</div>
								</li>
								<li>
									<h5>storage: <a href="../interfaces/src_core_kv_storage_interface.syncstoragenamespace.html" class="tsd-signature-type" data-tsd-kind="Interface">SyncStorageNamespace</a><span class="tsd-signature-symbol"> | </span><a href="src_core_kv_storage_interface.html#asyncstoragenamespace" class="tsd-signature-type" data-tsd-kind="Type alias">AsyncStorageNamespace</a></h5>
									<div class="tsd-comment tsd-typography">
										<p>storage to save data</p>
									</div>
								</li>
								<li>
									<h5><span class="tsd-flag ts-flagOptional">Optional</span> opts: <a href="../interfaces/src_core_cache_decorators_persistent_interface.persistentoptions.html" class="tsd-signature-type" data-tsd-kind="Interface">PersistentOptions</a></h5>
								</li>
							</ul>
							<h4 class="tsd-returns-title">Returns <span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><a href="src_core_cache_decorators_persistent_interface.html#persistentcache" class="tsd-signature-type" data-tsd-kind="Type alias">PersistentCache</a><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">V</span><span class="tsd-signature-symbol">, </span><span class="tsd-signature-type">string</span><span class="tsd-signature-symbol">, </span><a href="../interfaces/src_core_cache_decorators_helpers_add_emitter_interface.cachewithemitter.html" class="tsd-signature-type" data-tsd-kind="Interface">CacheWithEmitter</a><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">V</span><span class="tsd-signature-symbol">, </span><span class="tsd-signature-type">string</span><span class="tsd-signature-symbol">, </span><a href="../interfaces/src_core_cache_interface.default.html" class="tsd-signature-type" data-tsd-kind="Interface">default</a><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">V</span><span class="tsd-signature-symbol">, </span><span class="tsd-signature-type">string</span><span class="tsd-signature-symbol">&gt;</span><span class="tsd-signature-symbol">&gt;</span><span class="tsd-signature-symbol">&gt;</span><span class="tsd-signature-symbol">&gt;</span></h4>
						</li>
					</ul>
				</section>
			</section>
		</div>
		<div class="col-4 col-menu menu-sticky-wrap menu-highlight">
			<nav class="tsd-navigation primary">
				<ul>
					<li class=" ">
						<a href="../modules.html">Modules</a>
					</li>
					<li class="current tsd-kind-module">
						<a href="src_core_cache_decorators_persistent.html">src/core/cache/decorators/persistent</a>
					</li>
				</ul>
			</nav>
			<nav class="tsd-navigation secondary menu-sticky">
				<ul class="before-current">
					<li class=" tsd-kind-reference tsd-parent-kind-module">
						<a href="src_core_cache_decorators_persistent.html#persistentcache" class="tsd-kind-icon">Persistent<wbr>Cache</a>
					</li>
					<li class=" tsd-kind-reference tsd-parent-kind-module">
						<a href="src_core_cache_decorators_persistent.html#persistentoptions" class="tsd-kind-icon">Persistent<wbr>Options</a>
					</li>
					<li class=" tsd-kind-reference tsd-parent-kind-module">
						<a href="src_core_cache_decorators_persistent.html#persistentttldecoratoroptions" class="tsd-kind-icon">PersistentTTLDecorator<wbr>Options</a>
					</li>
					<li class=" tsd-kind-function tsd-parent-kind-module tsd-has-type-parameter">
						<a href="src_core_cache_decorators_persistent.html#default" class="tsd-kind-icon">default</a>
					</li>
				</ul>
			</nav>
		</div>
	</div>
</div>
<footer>
	<div class="container">
		<h2>Legend</h2>
		<div class="tsd-legend-group">
			<ul class="tsd-legend">
				<li class="tsd-kind-namespace"><span class="tsd-kind-icon">Namespace</span></li>
				<li class="tsd-kind-variable"><span class="tsd-kind-icon">Variable</span></li>
				<li class="tsd-kind-function"><span class="tsd-kind-icon">Function</span></li>
				<li class="tsd-kind-function tsd-has-type-parameter"><span class="tsd-kind-icon">Function with type parameter</span></li>
				<li class="tsd-kind-type-alias"><span class="tsd-kind-icon">Type alias</span></li>
				<li class="tsd-kind-type-alias tsd-has-type-parameter"><span class="tsd-kind-icon">Type alias with type parameter</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-interface"><span class="tsd-kind-icon">Interface</span></li>
				<li class="tsd-kind-interface tsd-has-type-parameter"><span class="tsd-kind-icon">Interface with type parameter</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-class"><span class="tsd-kind-icon">Class</span></li>
				<li class="tsd-kind-class tsd-has-type-parameter"><span class="tsd-kind-icon">Class with type parameter</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-enum"><span class="tsd-kind-icon">Enumeration</span></li>
			</ul>
		</div>
	</div>
</footer>
<div class="overlay"></div>
<script src="../assets/js/main.js"></script>
<script>'use strict';

/*!
 * V4Fire Core
 * https://github.com/V4Fire/Core
 *
 * Released under the MIT license
 * https://github.com/V4Fire/Core/blob/master/LICENSE
 */

(function () {
	document.body.style.display = 'block';

	var
		isDTS = /^index$|\.d$/,
		needHide = /\/(?:prelude|interface|const|modules|helpers|engines)\b/,
		isNode = /(?:^|\/)node_modules(?:\/|$)/;

	var
		trimRgxp = /^\s+|[\n\v"']+|\s+$/g,
		normalizeRgxp = /(?:^|\b)src\/|\/index$/g;

	var
		breadcrumbs = Array.from(document.querySelectorAll('.tsd-breadcrumb a')),
		headers = Array.from(document.querySelectorAll('h1'));

	breadcrumbs.forEach(function (el) {
		el.textContent = el.textContent.replace(trimRgxp, '').replace(normalizeRgxp, '');
	});

	headers.forEach(function (el) {
		el.textContent = el.textContent.replace(trimRgxp, '').replace(normalizeRgxp, '');
	});

	var
		navigation = Array.from(document.querySelectorAll('.tsd-navigation.primary .tsd-kind-module a')),
		globalIndex = Array.from(document.querySelectorAll('.tsd-kind-module a'));

	[].concat(breadcrumbs.length <= 1 ? globalIndex : navigation).forEach(function (el) {
		var
			wrapper = el.parentNode,
			linkText = el.textContent.replace(trimRgxp, '');

		if (isDTS.test(linkText)) {
			var
				nm = RegExp.$1;

			if (linkText === 'index') {
				el.innerHTML = '<b>prelude</b>';

			} else if (isNode.test(linkText)) {
				el.textContent = nm;

			} else {
				wrapper.parentNode.removeChild(wrapper);
			}

		} else if (needHide.test(linkText)) {
			wrapper.parentNode.removeChild(wrapper);

		} else {
			el.textContent = linkText.replace(normalizeRgxp, '');
		}
	});
})();
</script>
</body>
</html>